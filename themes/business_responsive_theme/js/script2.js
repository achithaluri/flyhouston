$(document).ready(function(){var flightSearch=$('#searchflight'),flightSearchText=flightSearch.find('input[type="text"]'),flightSearchResults=$('.searchflightresults');var search_fields=['airline_name','flight_number','gate','airline_code','airline_alt_code'];if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return this.indexOf(searchString,position)===position;};}
var toggleArrivalsDepartures=function(){if(window.is_arrival_page()){$('.searchflightresults.arrivals, .toggledirection span.departures').addClass('active');$('.searchflightresults.departures, .toggledirection span.arrivals').removeClass('active');}else{$('.searchflightresults.arrivals, .toggledirection span.departures').removeClass('active');$('.searchflightresults.departures, .toggledirection span.arrivals').addClass('active');}};$('.toggledirection').on('click',function(){$('.searchflightresults, .toggledirection span').toggleClass('active');});$('#navpanel nav a').on('click',function(){slug=$(this).attr('slug');if(slug==='arrive'){$('.searchflightresults.arrivals, .toggledirection span.departures').addClass('active');$('.searchflightresults.departures, .toggledirection span.arrivals').removeClass('active');}else{$('.searchflightresults.arrivals, .toggledirection span.departures').removeClass('active');$('.searchflightresults.departures, .toggledirection span.arrivals').addClass('active');}});window.display_flights=function(arrive_flights,depart_flights,search_terms){flightSearchResults.find('tr').remove();if(arrive_flights.length===0&&depart_flights.length===0){flightSearchResults.html('<tr class="no-match"><td></td><td colspan="6">No Matching Flights Found</td><td></td></tr>');$('.toggledirection').hide();}else{$('.toggledirection').show();var makeRows=function(array,tablewrap){var html='';for(var i=0,len=array.length;i<len;i++){var flight=array[i];var row='';try{row+='<tr flight-id="'+flight.id
+'"><td></td>'
+'<td>'+(flight.direction==='A'?ARRIVAL:DEPARTURE);row+='</td><td>'+flight.cities[0].name+' [<span>'+flight.cities[0].code+'</span>]';$.each(flight.cities.slice(1),function(_,item){row+='<div style="font-size: 80%">'+item.name
+' [<span>'+item.code+'</span>]'+'</div>';});row+='</td><td>'+flight.airline_name+' '+flight.flight_number;$.each(flight.code_shares,function(_,cs){row+='<div style="font-size: 80%">'
+cs.airline_name+' <span>'+cs.flight_number+'</span>'
+'</div>';});row+='</td><td>'
+get_gate_and_terminal(flight)
+'</td>';row+='<td>'
+flight.scheduled_day+' '
+flight.scheduled_time+'</td><td>'
+flight.smart_status;var updated_time_elem=window.get_updated_flight_div(flight);if(updated_time_elem!==null){row+=updated_time_elem.prop('outerHTML');}
row+='</td><td></td></tr>';html+=row;}catch(e){console.log({e:e,flight:flight});}}
tablewrap[0].innerHTML=html;};var a_tablewrap=$('.searchflightresults.arrivals');var a_array=arrive_flights;makeRows(a_array,a_tablewrap);var b_tablewrap=$('.searchflightresults.departures');var b_array=depart_flights;makeRows(b_array,b_tablewrap);}
toggleArrivalsDepartures();$('#flightlist').show();searchtablepadding();flightListClick();$.each(search_terms,function(i,term){$('.searchflightresults td').highlight(term);});};var search_handler=function(){var search_query=flightSearchText.val().trim();if(search_query){search_flights(search_query);}else{flightSearchResults[0].innerHTML='';}};flightSearchText.on('keydown',function(e){var CR=13;if(e.keyCode===CR){e.preventDefault();var selected=flightSearchResults.find('tr.selected');applyselectedflight(selected);}});var previous_search_query='';var keyupTimeout=null;flightSearchText.on('keyup',function(e){if(keyupTimeout!=null){clearTimeout(keyupTimeout);}
keyupTimeout=setTimeout(function(){globalTimeout=null;var search_query=flightSearchText.val().trim();if(search_query!==previous_search_query){previous_search_query=search_query;if(search_query){search_handler();}else{$('#flightlist').hide();}}
var DOWN_ARROW=40;var UP_ARROW=38;var old_tr,new_tr;if(e.keyCode===DOWN_ARROW){e.preventDefault();if(flightSearchResults.find('tr.selected').length){if(!flightSearchResults.find('tr:last-child.selected').length){old_tr=flightSearchResults.find('tr.selected');new_tr=old_tr.eq(0).next();new_tr.addClass('selected');old_tr.removeClass('selected');new_tr[0].scrollIntoView(false);}}else{flightSearchResults.find('tr:first-child').addClass('selected');}}
if(e.keyCode===UP_ARROW){e.preventDefault();if(flightSearchResults.find('tr.selected').length){if(!flightSearchResults.find('tr:first-child.selected').length){old_tr=flightSearchResults.find('tr.selected');new_tr=old_tr.eq(0).prev();new_tr.addClass('selected');old_tr.removeClass('selected');new_tr[0].scrollIntoView(false);}}}
flightSearchResults.find('tr').on({mouseenter:function(){$(this).addClass('selected').siblings().removeClass('selected');},mouseleave:function(){$(this).removeClass('selected');}});},400);});var flightListClick=function(){$('#flightlist .searchflightresults tr').on('click',function(e){e.preventDefault();applyselectedflight($(this));});};var applyselectedflight=function(selected){var flight_id=parseInt(selected.attr('flight-id'),10);console.log('selected flight id='+flight_id);var flight=null;$.each(window.flight_data,function(_,item){if(item.id===flight_id){flight=item;return false;}});set_chosen_flight(flight);if(window.get_current_fast_slug()!=='connect'){var fast_slug;if(flight.direction==='A'){fast_slug='arrive';}else{fast_slug='depart';}
fast_switch('/'+airport+'/'+fast_slug+'/',fast_slug);}
populate_market();auto_filter_cards_based_on_flight();populate_art();flightSearch.addClass('active open');$('#flightlist,#searchflight form').hide();$('#selectedflight,#searchflight #selectedflight > .row:nth-child(2)').show();populate_flight_card(flight);};var chosen_flight=get_chosen_flight();if(chosen_flight!==null){populate_flight_card(chosen_flight);flightSearch.addClass('active');}
$('#selectedflight .close').on('click',function(e){e.preventDefault();$('#selectedflight').hide();$('#searchflight form').show().css({display:'flex'});flightSearchText.val('');previous_search_query='';set_chosen_flight(null);populate_market();populate_art();});$('#selectedflight > .row:nth-child(2)').hide();$('#selectedflight .toggle').on('click',function(e){e.preventDefault();flightSearch.toggleClass('open');$('#selectedflight > .row:nth-child(2)').slideToggle(300);});var searchtablepadding=function(){var searchW=flightSearch.width();var searchformW=flightSearch.find('form').width();var searchformOffset=(searchW-searchformW)/2;$('#flightlist table th:first-child,#flightlist table td:first-child').css({'width':searchformOffset,'padding':'0px'});$('#flightlist table th:last-child,#flightlist table td:last-child').css({'width':searchformOffset,'padding':'0px'});var tableW=$('#flightlist .scroll table').width();var thead1=$('#flightlist .scroll table th:nth-child(2)').width();var thead2=$('#flightlist .scroll table th:nth-child(3)').width();var thead3=$('#flightlist .scroll table th:nth-child(4)').width();var thead4=$('#flightlist .scroll table th:nth-child(5)').width();var thead5=$('#flightlist .scroll table th:nth-child(6)').width();var thead6=$('#flightlist .scroll table th:nth-child(7)').width();$('#flightlist table.fixed th:nth-child(2)').width(thead1);$('#flightlist table.fixed th:nth-child(3)').width(thead2);$('#flightlist table.fixed th:nth-child(4)').width(thead3);$('#flightlist table.fixed th:nth-child(5)').width(thead4);$('#flightlist table.fixed th:nth-child(6)').width(thead5);$('#flightlist table.fixed th:nth-child(7)').width(thead6);tableW=$('#flightlist .scroll table').width();$('#flightlist table.fixed').width(tableW);};$(window).on('resize',function(){searchtablepadding();});if(window.houston_weather){update_weather_element(houston_weather,'#weather');}
var $win=$(window);var scrollNav=function(){var $scrollpos=$win.scrollTop(),$winH=$win.height();$('#headbg').css('transform','translateY(-'+$scrollpos/10+'px)');};scrollNav();$win.on('scroll',function(){scrollNav();});$('.security-checkpoint table tbody td:nth-child(2)').each(function(){var text=$(this).text().toLowerCase();if(text==='closed'){$(this).addClass('closed');}});$('.block.tabbed .block-head .title').on('click',function(){var $index=$(this).parent().index()+1;$(this).addClass('active').parent().siblings().find('.title').removeClass('active');$(this).closest('.tabbed').find('.block-tab > div:nth-child('+$index+')').show().siblings().hide();});var equal_heights_park_security=function(){var security=$('.security-checkpoint'),parking=$('.available-parking'),security_content=security.find('.block-content'),parking_content=parking.find('.block-content'),max_height;if(security.length&&parking.length){var equalize_heights=function(){security_content.add(parking_content).css('height','auto');max_height=Math.max(security_content.outerHeight(),parking_content.outerHeight());security_content.add(parking_content).css('height',max_height+'px');};equalize_heights();$(window).on('load resize',function(){equalize_heights();});}};equal_heights_park_security();var ellingtonspaceportHeader=function(){var winH=$win.height();var footH=$('footer').height();$('body.ellington-spaceport header').height(winH-footH);};ellingtonspaceportHeader();$($win).on('resize',function(){ellingtonspaceportHeader();});$('.image-gallery a.gallery').on('click',function(e){e.preventDefault();function getmodalinstance(){mpi=$.magnificPopup.instance;$('.modal .close').click(function(e){e.preventDefault();mpi.close();});}
var data_img=$(this).parent().parent().find('.title').text();var images=$(this).find('.carousel-top').html();$.magnificPopup.open({type:'inline',midClick:true,closeMarkup:'',items:{src:'<div id="gallery" class="modal">'+'<div class="head">'+'<a href="#" class="close" aria-label="Close"></a>'+'</div>'+'<div class="title"></div>'+'<div class="carousel-top">'+'<div class="owl-carousel"></div>'+'<div class="controls">'+'<div class="prev"></div>'+'<div class="caption">'+'<div class="name"></div>'+'<div class="link"><a href="#" download>Download Image</a></div>'+'</div>'+'<div class="next"></div>'+'</div>'+'</div>'+'<div class="carousel-bottom">'+'<div class="owl-carousel"></div>'+'<div class="controls">'+'<div class="prev"></div>'+'<div class="next"></div>'+'</div>'+'</div>'+'</div>'},callbacks:{open:function(){getmodalinstance();block_info=mpi.content.find('.title');block_info.text(data_img);mpi.content.find('.owl-carousel').html(images);mpi.content.find('.carousel-top img,.carousel-bottom img').each(function(){$src=$(this).data('src');$(this).attr('src',$src);});var $carouselT=mpi.content.find('.carousel-top'),$owlT=$carouselT.find('.owl-carousel'),$carouselB=mpi.content.find('.carousel-bottom'),$owlB=$carouselB.find('.owl-carousel');$owlT.on('initialized.owl.carousel changed.owl.carousel',function(e){current=e.item.index;activeText=$(e.target).find('.owl-item').eq(current).find('.item').data('name');activeLink=$(e.target).find('.owl-item').eq(current).find('.item').data('link');$carouselT.find('.controls .caption .name').text(activeText);$carouselT.find('.controls .caption .link a').attr('href',activeLink);});mpi.content.find('.carousel-top,.carousel-bottom').on('click','.prev:not(.disabled)',function(){mpi.content.find('.carousel-top .owl-carousel').trigger('prev.owl.carousel');});mpi.content.find('.carousel-top,.carousel-bottom').on('click','.next:not(.disabled)',function(){mpi.content.find('.carousel-top .owl-carousel').trigger('next.owl.carousel');});mpi.content.find('.owl-carousel').on('translate.owl.carousel',function(){mpi.content.find('.prev,.next').addClass('disabled');});mpi.content.find('.owl-carousel').on('translated.owl.carousel',function(){mpi.content.find('.prev,.next').removeClass('disabled');mpi.content.find('.owl-item.owl-prev').removeClass('owl-prev');mpi.content.find('.owl-item.owl-next').removeClass('owl-next');});$owlT.owlCarousel({nav:false,dots:false,loop:true,items:1,margin:0,smartSpeed:500,autoHeight:false,center:true});$owlT.on('changed.owl.carousel',function(e){$owlB.trigger('to.owl.carousel',[e.item.index-(e.item.count/2),500,true]);});if($owlB.find('.item').length>4){$owlB.owlCarousel({nav:false,dots:false,loop:true,items:5,margin:15,smartSpeed:500,autoHeight:false,center:false});$owlB.on('click','.owl-item',function(e){$owlT.trigger('to.owl.carousel',[$(this).index()-5,500,true]);});}else{$owlB.owlCarousel({nav:false,dots:false,loop:false,items:5,margin:15,smartSpeed:500,autoHeight:false,center:false});$carouselB.find('.controls').hide();$owlB.on('click','.owl-item',function(e){$owlT.trigger('to.owl.carousel',[$(this).index(),500,true]);});}},close:function(){mpi.content.find('.owl-carousel').trigger('destroy.owl.carousel');}}});});var tab_scroll_top_key='tab_scroll_top';var tab_scroll_top=null;try{tab_scroll_top=sessionStorage.getItem(tab_scroll_top_key);}catch(e){console.log('Session storage not available');}
if(tab_scroll_top){$(document).scrollTop(tab_scroll_top);try{sessionStorage.removeItem(tab_scroll_top_key);}catch(e){console.log('Session storage not available');}}
$('.subnav, .subnavtabs').find('li:not(.active) a').on('click',function(e){try{sessionStorage.setItem(tab_scroll_top_key,$(document).scrollTop());}catch(e2){console.log('Session storage not available');}});if(airport){var airport_nav_slug=window.get_current_fast_slug();var fast_slugs=['depart','arrive','connect','overview'];var can_fast_switch=fast_slugs.indexOf(airport_nav_slug)>-1;if(!airport_nav_slug){airport_nav_slug='overview';}
var nav_links={depart:'Depart',arrive:'Arrive',connect:'Connect','pick-up':'Pick-up/Drop-off',overview:'Overview'};var nav_images={};var navpanel=$('#navpanel');var navoptions=navpanel.find('.navoptions');var fast_switch=function(link_url,link_slug){if(can_fast_switch&&fast_slugs.indexOf(link_slug)>-1){currentpage(link_slug);window.fast_switch_helper(fast_slugs,nav_links,link_slug,link_url);populate_art();var new_hero_image=window.fast_switch_hero_images[link_slug];if(new_hero_image.trim()){$('#headbg').css('background-image',new_hero_image);}}};var currentpage=function(slug){$('#navpanel nav a').removeClass('current');$('#navpanel nav a[slug="'+slug+'"]').addClass('current');if(slug==='arrive'||slug==='connect'){$('.parking-security-row').hide();}else{$('.parking-security-row').show();}};currentpage(airport_nav_slug);$('#navpanel nav a').on('click',function(e){var link=$(this);var link_url=link.attr('href');var link_slug=link.attr('slug');if(can_fast_switch&&fast_slugs.indexOf(link_slug)>-1){fast_switch(link_url,link_slug);searchtablepadding();e.preventDefault();}});}
populate_market();auto_filter_cards_based_on_flight();populate_art();if(!$('.filtercardwrap.mobile').length){$(document).on('tkloaded',function(){window.refreshEqualCardHeight();var throttle;window.onresize=function(){clearTimeout(throttle);throttle=setTimeout(window.refreshEqualCardHeight,100);};});}
$(document).ajaxComplete(function(){$('.portlet').each(function(){portletcard=$(this).find('.card');equalCardHeight(portletcard,4);});});$('#navpanel #airports').on('click','.col:not(.contract)',function(){if($(this).hasClass('iah')){$(this).addClass('expand').parent().addClass('iah');}else{$(this).addClass('expand').parent().addClass('hou');}
$(this).siblings('.col').addClass('contract');});$('#navpanel #airports').on('click','.col.contract',function(){$(this).removeClass('contract');$(this).siblings('.col').removeClass('expand').parent().removeClass('iah hou');});});